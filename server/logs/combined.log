{"level":"warn","message":"OPENAI_API_KEY not found. AI features will be disabled.","service":"howparth-api","timestamp":"2025-08-29 21:54:55"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-29 21:54:55"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-29 21:54:55"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-29 22:10:12"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-29 22:10:12"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-29 22:10:12"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 05:17:22"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-30 05:17:22"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 05:17:22"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 05:23:43"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-30 05:23:43"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 05:23:43"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-08-30 05:28:57"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 05:33:41"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-30 05:33:41"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 05:33:41"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 05:40:46"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-30 05:40:46"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 05:40:46"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 05:45:36"}
{"level":"info","message":"Server running on port 3001","service":"howparth-api","timestamp":"2025-08-30 05:45:36"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 05:45:36"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 05:55:42"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-08-30 05:55:42"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 05:55:42"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-08-30 05:55:42"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 05:55:42"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-08-30 06:19:25"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 06:19:46"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-08-30 06:19:46"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 06:19:46"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-08-30 06:19:46"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 06:19:46"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 06:23:45"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-08-30 06:23:45"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 06:23:45"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-08-30 06:23:45"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 06:23:45"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 06:33:02"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-08-30 06:33:02"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 06:33:02"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-08-30 06:33:02"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 06:33:02"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 07:02:22"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-08-30 07:02:22"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 07:02:22"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-08-30 07:02:22"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 07:02:22"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 07:02:48"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-08-30 07:02:48"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 07:02:48"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-08-30 07:02:48"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 07:02:48"}
{"clientVersion":"5.22.0","level":"error","message":"Login error: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/routes/auth.js:144:36\n\n  141 const { email, password } = req.body;\n  142 \n  143 // Find user\n→ 144 const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1","name":"PrismaClientInitializationError","service":"howparth-api","stack":"PrismaClientInitializationError: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/routes/auth.js:144:36\n\n  141 const { email, password } = req.body;\n  142 \n  143 // Find user\n→ 144 const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1\n    at $n.handleRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:7615)\n    at $n.handleAndLogRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at async l (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/auth.js:144:18","timestamp":"2025-08-30 07:12:18"}
{"level":"error","message":"Signup error: Cannot read properties of undefined (reading 'id')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'id')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:132:22","timestamp":"2025-08-30 07:31:51"}
{"level":"error","message":"Signup error: Cannot read properties of undefined (reading 'id')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'id')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:132:22","timestamp":"2025-08-30 07:31:51"}
{"level":"error","message":"Signup error: Cannot read properties of undefined (reading 'id')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'id')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:132:22","timestamp":"2025-08-30 07:31:51"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:31:52"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:31:52"}
{"level":"error","message":"Logout error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:473:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:31:52"}
{"level":"error","message":"Signup error: crypto.createCipher is not a function","service":"howparth-api","stack":"TypeError: crypto.createCipher is not a function\n    at encryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:52:25)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:165:23","timestamp":"2025-08-30 07:32:27"}
{"level":"error","message":"Login error: crypto.createCipher is not a function","service":"howparth-api","stack":"TypeError: crypto.createCipher is not a function\n    at encryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:52:25)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:273:23","timestamp":"2025-08-30 07:32:27"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:32:28"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:32:28"}
{"level":"info","message":"Email verified for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:28"}
{"level":"info","message":"Password reset email sent to: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:28"}
{"level":"info","message":"Password reset for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:28"}
{"level":"error","message":"MFA setup error: crypto.createCipher is not a function","service":"howparth-api","stack":"TypeError: crypto.createCipher is not a function\n    at encryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:52:25)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:751:29\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-30 07:32:29"}
{"level":"error","message":"MFA verification error: crypto.createDecipher is not a function","service":"howparth-api","stack":"TypeError: crypto.createDecipher is not a function\n    at decryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:65:27)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:811:20\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-30 07:32:29"}
{"level":"error","message":"MFA verification error: crypto.createDecipher is not a function","service":"howparth-api","stack":"TypeError: crypto.createDecipher is not a function\n    at decryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:65:27)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:882:20\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-30 07:32:29"}
{"level":"error","message":"Logout error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:473:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:32:29"}
{"level":"info","message":"New user registered: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:55"}
{"level":"error","message":"Signup error: token is not defined","service":"howparth-api","stack":"ReferenceError: token is not defined\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:184:9","timestamp":"2025-08-30 07:32:55"}
{"level":"info","message":"User logged in: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:56"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:32:57"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:32:57"}
{"level":"info","message":"Email verified for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:57"}
{"level":"info","message":"Password reset email sent to: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:57"}
{"level":"info","message":"Password reset for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:32:57"}
{"code":"ERR_CRYPTO_INVALID_IV","level":"error","message":"MFA verification error: Invalid initialization vector","service":"howparth-api","stack":"TypeError: Invalid initialization vector\n    at Decipheriv.createCipherBase (node:internal/crypto/cipher:121:19)\n    at Decipheriv.createCipherWithIV (node:internal/crypto/cipher:133:3)\n    at new Decipheriv (node:internal/crypto/cipher:278:3)\n    at Object.createDecipheriv (node:crypto:147:10)\n    at decryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:65:27)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:811:20\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-30 07:32:57"}
{"code":"ERR_CRYPTO_INVALID_IV","level":"error","message":"MFA verification error: Invalid initialization vector","service":"howparth-api","stack":"TypeError: Invalid initialization vector\n    at Decipheriv.createCipherBase (node:internal/crypto/cipher:121:19)\n    at Decipheriv.createCipherWithIV (node:internal/crypto/cipher:133:3)\n    at new Decipheriv (node:internal/crypto/cipher:278:3)\n    at Object.createDecipheriv (node:crypto:147:10)\n    at decryptData (/Users/opium/HOWPARTH/howparth/server/routes/auth.js:65:27)\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:882:20\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-08-30 07:32:57"}
{"level":"error","message":"Logout error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:473:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:32:57"}
{"level":"info","message":"New user registered: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:34:24"}
{"level":"info","message":"User logged in: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:34:24"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:34:25"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:34:25"}
{"level":"info","message":"Email verified for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:34:25"}
{"level":"info","message":"Password reset email sent to: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:34:25"}
{"level":"info","message":"Password reset for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:34:26"}
{"level":"error","message":"Logout error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:473:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:34:26"}
{"level":"info","message":"New user registered: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:35:41"}
{"level":"info","message":"User logged in: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:35:42"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:35:43"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:35:43"}
{"level":"info","message":"Email verified for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:35:43"}
{"level":"info","message":"Password reset email sent to: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:35:43"}
{"level":"info","message":"Password reset for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:35:43"}
{"level":"info","message":"MFA enabled for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:35:43"}
{"level":"error","message":"Logout error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:473:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:35:43"}
{"level":"info","message":"New user registered: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:36:06"}
{"level":"info","message":"User logged in: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:36:07"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:36:08"}
{"level":"error","message":"Token refresh error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:375:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:36:08"}
{"level":"info","message":"Email verified for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:36:08"}
{"level":"info","message":"Password reset email sent to: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:36:08"}
{"level":"info","message":"Password reset for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:36:08"}
{"level":"info","message":"MFA enabled for user: test@example.com","service":"howparth-api","timestamp":"2025-08-30 07:36:08"}
{"level":"error","message":"Logout error: Cannot read properties of undefined (reading 'refreshToken')","service":"howparth-api","stack":"TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at /Users/opium/HOWPARTH/howparth/server/routes/auth.js:473:38\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/opium/HOWPARTH/howparth/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-08-30 07:36:08"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 14:33:07"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3002","service":"howparth-api","timestamp":"2025-08-30 14:33:07"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 14:33:07"}
{"level":"info","message":"🔗 Health check: http://localhost:3002/health","service":"howparth-api","timestamp":"2025-08-30 14:33:07"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 14:33:07"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-08-30 14:56:52"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-08-30 14:56:52"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-08-30 15:04:19"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3002","service":"howparth-api","timestamp":"2025-08-30 15:04:19"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-08-30 15:04:19"}
{"level":"info","message":"🔗 Health check: http://localhost:3002/health","service":"howparth-api","timestamp":"2025-08-30 15:04:19"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-08-30 15:04:19"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 02:58:47"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 02:58:47"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 02:58:47"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 02:58:47"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 02:58:47"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 03:15:47"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 03:15:47"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 03:15:47"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 03:15:47"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 03:15:47"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 03:17:43"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 03:17:43"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 03:17:43"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 03:17:43"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 03:17:43"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 03:18:27"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 03:18:27"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 03:18:27"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 03:18:27"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 03:18:27"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-09-02 03:19:28"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 03:21:09"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 03:21:09"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 03:21:09"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 03:21:09"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 03:21:09"}
{"clientVersion":"5.22.0","level":"error","message":"Failed to get user API key: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:38\n\n  110 // Get and decrypt user's API key\n  111 async getUserApiKey(userId) {\n  112   try {\n→ 113     const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1","name":"PrismaClientInitializationError","service":"howparth-api","stack":"PrismaClientInitializationError: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:38\n\n  110 // Get and decrypt user's API key\n  111 async getUserApiKey(userId) {\n  112   try {\n→ 113     const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1\n    at $n.handleRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:7615)\n    at $n.handleAndLogRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at async l (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at async APIKeyService.getUserApiKey (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:20)\n    at async APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:138:22)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 03:21:21"}
{"level":"error","message":"Failed to create OpenAI client for user: No valid OpenAI API key found for user","service":"howparth-api","stack":"Error: No valid OpenAI API key found for user\n    at APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:141:15)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 03:21:21"}
{"level":"error","message":"Chat response generation error: No valid OpenAI API key found for user","service":"howparth-api","stack":"Error: No valid OpenAI API key found for user\n    at APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:141:15)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 03:21:21"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-09-02 03:21:43"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 03:23:47"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 03:23:47"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 03:23:47"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 03:23:47"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 03:23:47"}
{"clientVersion":"5.22.0","level":"error","message":"Failed to get user API key: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:38\n\n  110 // Get and decrypt user's API key\n  111 async getUserApiKey(userId) {\n  112   try {\n→ 113     const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1","name":"PrismaClientInitializationError","service":"howparth-api","stack":"PrismaClientInitializationError: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:38\n\n  110 // Get and decrypt user's API key\n  111 async getUserApiKey(userId) {\n  112   try {\n→ 113     const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1\n    at $n.handleRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:7615)\n    at $n.handleAndLogRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at async l (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at async APIKeyService.getUserApiKey (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:20)\n    at async APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:138:22)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 03:24:09"}
{"level":"error","message":"Failed to create OpenAI client for user: No valid OpenAI API key found for user","service":"howparth-api","stack":"Error: No valid OpenAI API key found for user\n    at APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:141:15)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 03:24:09"}
{"level":"error","message":"Chat response generation error: No valid OpenAI API key found for user","service":"howparth-api","stack":"Error: No valid OpenAI API key found for user\n    at APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:141:15)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 03:24:09"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-09-02 20:25:54"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 20:26:01"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 20:26:01"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 20:26:01"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 20:26:01"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 20:26:01"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-09-02 20:32:21"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 20:32:26"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 20:32:26"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 20:32:26"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 20:32:26"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 20:32:26"}
{"clientVersion":"5.22.0","level":"error","message":"Failed to get user API key: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:38\n\n  110 // Get and decrypt user's API key\n  111 async getUserApiKey(userId) {\n  112   try {\n→ 113     const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1","name":"PrismaClientInitializationError","service":"howparth-api","stack":"PrismaClientInitializationError: \nInvalid `prisma.user.findUnique()` invocation in\n/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:38\n\n  110 // Get and decrypt user's API key\n  111 async getUserApiKey(userId) {\n  112   try {\n→ 113     const user = await prisma.user.findUnique(\nerror: Environment variable not found: DATABASE_URL.\n  -->  schema.prisma:10\n   | \n 9 |   provider = \"postgresql\"\n10 |   url      = env(\"DATABASE_URL\")\n   | \n\nValidation Error Count: 1\n    at $n.handleRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:7615)\n    at $n.handleAndLogRequestError (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at async l (/Users/opium/HOWPARTH/howparth/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at async APIKeyService.getUserApiKey (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:113:20)\n    at async APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:138:22)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 20:32:36"}
{"level":"error","message":"Failed to create OpenAI client for user: No valid OpenAI API key found for user","service":"howparth-api","stack":"Error: No valid OpenAI API key found for user\n    at APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:141:15)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 20:32:36"}
{"level":"error","message":"Chat response generation error: No valid OpenAI API key found for user","service":"howparth-api","stack":"Error: No valid OpenAI API key found for user\n    at APIKeyService.getOpenAIClient (/Users/opium/HOWPARTH/howparth/server/services/apiKeyService.js:141:15)\n    at async AIService.generateChatResponse (/Users/opium/HOWPARTH/howparth/server/services/aiService.js:119:22)\n    at async RealAIChatController.handleStreamingChat (/Users/opium/HOWPARTH/howparth/server/controllers/realAIChatController.js:40:22)\n    at async /Users/opium/HOWPARTH/howparth/server/routes/chat.js:35:3","timestamp":"2025-09-02 20:32:36"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-09-02 20:33:10"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 20:33:16"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 20:33:16"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 20:33:16"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 20:33:16"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 20:33:16"}
{"level":"info","message":"SIGTERM received, shutting down gracefully","service":"howparth-api","timestamp":"2025-09-02 20:40:45"}
{"level":"info","message":"AI Service initialized - using per-user API keys","service":"howparth-api","timestamp":"2025-09-02 20:40:51"}
{"level":"info","message":"🚀 Backend server running on http://localhost:3001","service":"howparth-api","timestamp":"2025-09-02 20:40:51"}
{"level":"info","message":"📁 Working directory: /Users/opium/HOWPARTH/howparth","service":"howparth-api","timestamp":"2025-09-02 20:40:51"}
{"level":"info","message":"🔗 Health check: http://localhost:3001/health","service":"howparth-api","timestamp":"2025-09-02 20:40:51"}
{"level":"info","message":"Environment: development","service":"howparth-api","timestamp":"2025-09-02 20:40:51"}
